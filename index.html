<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cherish</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1 id="logo">Cherish</h1>
    </header>

    <main>
        <!-- 控制按钮 -->
        <div class="controls">
            <button id="prevBtn">Previous</button>
            <button id="playBtn">Play</button>
            <button id="pauseBtn">Pause</button>
            <button id="nextBtn">Next</button>
        </div>

        <!-- 播放列表示例 -->
        <section id="playlist">
            <h2>Playlist</h2>
            <ul id="songList">
                <!-- 歌曲列表由 JS 动态生成 -->
            </ul>
        </section>

        <!-- 历史播放记录窗口 -->
        <div id="historyWindow" style="display:none; position:fixed; right:10px; top:10px; width:300px; height:400px; background:#fff; border:1px solid #ccc; overflow:auto; z-index:1000;">
            <h3>History</h3>
            <div id="historyList"></div>
            <button onclick="closeHistory()">Close</button>
        </div>
        <button onclick="openHistory()">Open History</button>
    </main>

    <footer>
        <!-- 版权信息已删除 -->
    </footer>

    <script src="script.js"></script>
    <script>
        // ----------------------------
        // 自动生成用户 ID
        // ----------------------------
        function getUserId() {
            let userId = localStorage.getItem("userId");
            if (!userId) {
                userId = "user_" + Date.now() + "_" + Math.floor(Math.random()*10000);
                localStorage.setItem("userId", userId);
            }
            return userId;
        }
        const userId = getUserId();

        // ----------------------------
        // 历史播放记录
        // ----------------------------
        function addToHistory(song) {
            let history = JSON.parse(localStorage.getItem("history") || "[]");
            history.push({ ...song, playedAt: Date.now() });
            localStorage.setItem("history", JSON.stringify(history));
            renderHistory();
        }

        function loadHistory() {
            return JSON.parse(localStorage.getItem("history") || "[]");
        }

        function renderHistory() {
            const history = loadHistory();
            const container = document.getElementById("historyList");
            container.innerHTML = "";
            history.slice(-20).reverse().forEach(song => {
                const btn = document.createElement("div");
                btn.className = "play-btn"; // 可复用原版按钮样式
                btn.textContent = song.title + " - " + song.artist;
                btn.onclick = () => playSong(song.songId);
                container.appendChild(btn);
            });
        }

        function openHistory() {
            document.getElementById("historyWindow").style.display = "block";
            renderHistory();
        }

        function closeHistory() {
            document.getElementById("historyWindow").style.display = "none";
        }

        // ----------------------------
        // 播放逻辑示例（原版播放方法复用）
        // ----------------------------
        function playSong(songId) {
            console.log("Playing song ID:", songId);
            // 调用原版播放逻辑
            // 例如：player.play(songId);
        }

        // ----------------------------
        // 示例歌曲列表
        // ----------------------------
        const songs = [
            { songId:"001", title:"Song A", artist:"Artist 1" },
            { songId:"002", title:"Song B", artist:"Artist 2" },
            { songId:"003", title:"Song C", artist:"Artist 3" }
        ];

        const songListEl = document.getElementById("songList");
        songs.forEach(song => {
            const li = document.createElement("li");
            li.textContent = song.title + " - " + song.artist;
            const playBtn = document.createElement("button");
            playBtn.textContent = "Play";
            playBtn.onclick = () => {
                playSong(song.songId);
                addToHistory(song);
            };
            li.appendChild(playBtn);
            songListEl.appendChild(li);
        });
    </script>
</body>
</html>
